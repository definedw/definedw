---
title: 关于ftp的一点
date: 2017-05-02 10:21:52
tags:
categories: Coding
---

>本文为作者原创，转载请注明出处！


昨晚弄了一下服务器，发现今早起来发现部署的网页有些问题，便四处找了找问题。

### 项目上传后Premission

因hexo采用的ftpsync插件，经常有很多问题。要不然就是连不上服务器，要不然就是node莫名其妙报错，说实话我是实在想换了，但暂时还没有一个很好的替换方案。暂时先折腾下。

一般对Linux接触过的人都会对Premission比较敏感，我本地上传之前检查了自己的目录情况下，文件夹755，文件644。不知道文件权限的请自行百度。听过的一种说法是尽量保证页面的安全性，但不做评论吧。我遇到的问题是，我的文件夹上传到服务器上的时候权限变成了700。

PS：假设你创建了用户组hexo，然后你没有专门用于ftp上传的话，请记得检查hexo目录的所有者，否则ftp上传的时候很容易报错`fatal 550`。更改用户组：

`sudo chown -R hexo:hexo /home/path`

**服务器情况：**

* 建立了专门的用户组来作为ftp上传。
* 文件可以上传，index页面可以显示，但是二级页面后的页面一直是访问不到。

**解决方法：**

1. 先检查自己的vsftpd.conf文件，查看 local_umask=022是否放开注释。注意，修改配置后记得重启vsftpd。
2. 如果以上配置没有生效，我在另外一个网站看到一个方案，只是我没测试过：在网站根目录下`umask=0022`，测试上传不成功的话`vi .bashrc`在文件中另起一行输入`umask 022`。保存后重启sshd 

### 解决以往文件权限问题

以下两个批量处理命令

* 将文件夹权限处理为755；`find -type d|xargs chmod 755`
* 将文件批量处理644；`find -type -f|xargs chmod 644`

**请在目标目录下处理**



